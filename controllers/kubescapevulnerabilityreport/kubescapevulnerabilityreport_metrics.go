package kubescapevulnerabilityreport

	import (
		"github.com/prometheus/client_golang/prometheus"
		"sigs.k8s.io/controller-runtime/pkg/metrics"

		"github.com/giantswarm/starboard-exporter/utils"
	)

	var (
		// KubescapeVulnerabilitySummary tracks vulnerability counts per image
		// TODO: Implement metric publishing in future PR
		KubescapeVulnerabilitySummary = prometheus.NewGaugeVec(
			prometheus.GaugeOpts{
				Namespace: "starboard_exporter",
				Subsystem: "kubescapevulnerabilityreport",
				Name:      "image_vulnerability_severity_count",
				Help:      "Exposes the number of vulnerabilities of a particular severity per-image from 
Kubescape.",
			},
			[]string{"report_name", "image_namespace", "image_registry", "image_repository", "image_tag",
"severity"},
		)
	)

	func init() {
		// Register custom metrics with the global prometheus registry
		metrics.Registry.MustRegister(KubescapeVulnerabilitySummary)
	}